
Step 1: 读取数据并构建四特征...
Step 2: 构建四输入样本...
f:\Codes\Wd-Pred\LSTM_prediction.py:67: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
Step 3: 构建四输入神经网络 (Vocab=321)...
Step 4: 开始训练 (Epochs=10, Batch=1024)...
Epoch 1/10

































































3505/3505 [==============================] - 146s 41ms/step - loss: 1.5716 - output_steps_loss: 1.4994 - output_success_loss: 0.1444 - output_success_accuracy: 0.9620 - val_loss: 1.5592 - val_output_steps_loss: 1.4999 - val_output_success_loss: 0.1186 - val_output_success_accuracy: 0.9643
Epoch 2/10









































































3505/3505 [==============================] - 162s 46ms/step - loss: 1.3577 - output_steps_loss: 1.2973 - output_success_loss: 0.1208 - output_success_accuracy: 0.9639 - val_loss: 1.5372 - val_output_steps_loss: 1.4779 - val_output_success_loss: 0.1185 - val_output_success_accuracy: 0.9642
Epoch 3/10
























































































3505/3505 [==============================] - 194s 55ms/step - loss: 1.3491 - output_steps_loss: 1.2897 - output_success_loss: 0.1188 - output_success_accuracy: 0.9643 - val_loss: 1.6088 - val_output_steps_loss: 1.5501 - val_output_success_loss: 0.1172 - val_output_success_accuracy: 0.9644
Epoch 4/10
























































































3505/3505 [==============================] - 194s 55ms/step - loss: 1.3461 - output_steps_loss: 1.2872 - output_success_loss: 0.1179 - output_success_accuracy: 0.9644 - val_loss: 1.5292 - val_output_steps_loss: 1.4700 - val_output_success_loss: 0.1184 - val_output_success_accuracy: 0.9641
Epoch 5/10




































































3505/3505 [==============================] - 149s 42ms/step - loss: 1.3442 - output_steps_loss: 1.2855 - output_success_loss: 0.1176 - output_success_accuracy: 0.9645 - val_loss: 1.6206 - val_output_steps_loss: 1.5608 - val_output_success_loss: 0.1196 - val_output_success_accuracy: 0.9640
Epoch 6/10





































































3505/3505 [==============================] - 150s 43ms/step - loss: 1.3428 - output_steps_loss: 1.2841 - output_success_loss: 0.1173 - output_success_accuracy: 0.9645 - val_loss: 1.5979 - val_output_steps_loss: 1.5394 - val_output_success_loss: 0.1169 - val_output_success_accuracy: 0.9646
Epoch 7/10




































































3505/3505 [==============================] - 150s 43ms/step - loss: 1.3418 - output_steps_loss: 1.2832 - output_success_loss: 0.1172 - output_success_accuracy: 0.9645 - val_loss: 1.5967 - val_output_steps_loss: 1.5380 - val_output_success_loss: 0.1173 - val_output_success_accuracy: 0.9643
Epoch 8/10






























































3505/3505 [==============================] - 137s 39ms/step - loss: 1.3409 - output_steps_loss: 1.2824 - output_success_loss: 0.1171 - output_success_accuracy: 0.9646 - val_loss: 1.5972 - val_output_steps_loss: 1.5374 - val_output_success_loss: 0.1196 - val_output_success_accuracy: 0.9639
Epoch 9/10































































3505/3505 [==============================] - 141s 40ms/step - loss: 1.3404 - output_steps_loss: 1.2819 - output_success_loss: 0.1170 - output_success_accuracy: 0.9646 - val_loss: 1.6202 - val_output_steps_loss: 1.5609 - val_output_success_loss: 0.1186 - val_output_success_accuracy: 0.9639
Epoch 10/10































































3505/3505 [==============================] - 140s 40ms/step - loss: 1.3399 - output_steps_loss: 1.2814 - output_success_loss: 0.1169 - output_success_accuracy: 0.9646 - val_loss: 1.6019 - val_output_steps_loss: 1.5429 - val_output_success_loss: 0.1180 - val_output_success_accuracy: 0.9641
✅ Loss曲线已保存至: visualization\LSTM_loss_curve.png
✅ 模型已成功保存到文件夹: LSTM_Model
Step 4: 开始批量预测，显示进度条...





877/877 [==============================] - 11s 12ms/step
========================================
  LSTM模型验证报告 (Validation Report)
========================================
1. 平均步数误差 (MAE)    : 1.0121
2. 均方根误差 (RMSE)     : 1.2421
3. 胜负预测准确率        : 96.406%
4. ROC曲线下面积 (AUC)   : 0.8754
5. 大型误差率 (>1.5步)  : 24.088%
========================================
Step 5: 启动回测验证抽样报告 (样本数=100000, 输出至 output.txt)...
------------------------------------------------------------
User ID    | Bias  | Diff  | Real  | Pred  | Err   | Status
------------------------------------------------------------
352497     | 5.29  | 4.17  | 6    | 4.72  | 1.28  | ⚠️
607228     | 4.06  | 4.39  | 6    | 3.77  | 2.23  | ❌
297763     | 3.77  | 4.47  | 5    | 3.51  | 1.49  | ⚠️
458774     | 6.12  | 4.03  | 6    | 5.22  | 0.78  | ✅
679966     | 6.00  | 4.45  | 6    | 5.56  | 0.44  | ✅
88121      | 3.88  | 4.14  | 4    | 3.31  | 0.69  | ✅
294246     | 5.17  | 4.20  | 6    | 4.86  | 1.14  | ⚠️
655717     | 5.43  | 4.09  | 5    | 4.57  | 0.43  | ✅
447046     | 4.71  | 4.44  | 3    | 4.38  | 1.38  | ⚠️
760407     | 3.71  | 4.25  | 6    | 3.42  | 2.58  | ❌
... (其余 99990 条省略)
✅ 抽样报告已成功导出至 output.txt 文件。
✅ 预测趋势图已保存至: visualization\LSTM_prediction_trends.png