===== 加载所有预处理数据集 =====
Step 1: 加载预处理后的数据 - train_data.csv
  读取数据集完成，共3632544条记录，耗时: 2.49秒
  创建单词ID完成，词汇表大小: 321，耗时: 17.77秒
  读取单词难度数据...
  读取用户水平数据...
  构建历史数据映射...
  数据加载和预处理完成，总耗时: 28.48秒
  性能统计:
    - 数据读取: 2.49秒
    - 单词ID创建: 17.77秒
    - 单词难度加载: 0.13秒
    - 用户水平加载: 0.17秒
    - 历史映射构建: 6.58秒
Step 1: 加载预处理后的数据 - val_data.csv
  读取数据集完成，共518935条记录，耗时: 0.38秒
  创建单词ID完成，词汇表大小: 321，耗时: 2.75秒
  读取单词难度数据...
  读取用户水平数据...
  构建历史数据映射...
  数据加载和预处理完成，总耗时: 9.06秒
  性能统计:
    - 数据读取: 0.38秒
    - 单词ID创建: 2.75秒
    - 单词难度加载: 0.04秒
    - 用户水平加载: 0.14秒
    - 历史映射构建: 5.65秒
Step 1: 加载预处理后的数据 - test_data.csv
  读取数据集完成，共1037870条记录，耗时: 0.74秒
  创建单词ID完成，词汇表大小: 321，耗时: 5.27秒
  读取单词难度数据...
  读取用户水平数据...
  构建历史数据映射...
  数据加载和预处理完成，总耗时: 12.43秒
  性能统计:
    - 数据读取: 0.74秒
    - 单词ID创建: 5.27秒
    - 单词难度加载: 0.04秒
    - 用户水平加载: 0.13秒
    - 历史映射构建: 6.04秒
Step 2: 构建四输入样本...
数据集构建完成: 共2468390个样本
Step 2: 构建四输入样本...
数据集构建完成: 共83482个样本
Step 2: 构建四输入样本...
数据集构建完成: 共374266个样本
===== 所有数据集准备完成 =====
数据集划分：训练集 2468390, 验证集 83482, 测试集 374266
Traceback (most recent call last):
  File "f:\Codes\Wd-Pred\transformer_prediction.py", line 933, in <module>
    main()
  File "f:\Codes\Wd-Pred\transformer_prediction.py", line 712, in main
    train_ds = make_ds(train_idx, is_train=True)
                       ^^^^^^^^^
NameError: name 'train_idx' is not defined
