
Step 1: è¯»å–æ•°æ®å¹¶æ„å»ºå››ç‰¹å¾...
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
f:\Codes\Wd-Pred\LSTM_prediction.py:80: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›† 2770743, éªŒè¯é›† 395820, æµ‹è¯•é›† 791642
Step 3: æ„å»ºå››è¾“å…¥ç¥ç»ç½‘ç»œ (Vocab=321)...
Step 4: å¼€å§‹è®­ç»ƒ (Epochs=10, Batch=2048)...
Epoch 1/10



































































































1353/1353 [==============================] - 212s 155ms/step - loss: 1.6492 - output_steps_loss: 1.5708 - output_success_loss: 0.1567 - output_success_accuracy: 0.9545 - val_loss: 1.3366 - val_output_steps_loss: 1.2780 - val_output_success_loss: 0.1173 - val_output_success_accuracy: 0.9664
Epoch 2/10














































































































1353/1353 [==============================] - 234s 173ms/step - loss: 1.3261 - output_steps_loss: 1.2670 - output_success_loss: 0.1182 - output_success_accuracy: 0.9669 - val_loss: 1.3214 - val_output_steps_loss: 1.2654 - val_output_success_loss: 0.1120 - val_output_success_accuracy: 0.9671
Epoch 3/10



















































































































1353/1353 [==============================] - 242s 179ms/step - loss: 1.3016 - output_steps_loss: 1.2450 - output_success_loss: 0.1131 - output_success_accuracy: 0.9673 - val_loss: 1.3636 - val_output_steps_loss: 1.3079 - val_output_success_loss: 0.1113 - val_output_success_accuracy: 0.9676
Epoch 4/10

















































































































1353/1353 [==============================] - 241s 178ms/step - loss: 1.2948 - output_steps_loss: 1.2388 - output_success_loss: 0.1120 - output_success_accuracy: 0.9675 - val_loss: 1.4110 - val_output_steps_loss: 1.3554 - val_output_success_loss: 0.1113 - val_output_success_accuracy: 0.9676
Epoch 5/10



















































































































1353/1353 [==============================] - 242s 179ms/step - loss: 1.2924 - output_steps_loss: 1.2367 - output_success_loss: 0.1115 - output_success_accuracy: 0.9676 - val_loss: 1.3623 - val_output_steps_loss: 1.3068 - val_output_success_loss: 0.1109 - val_output_success_accuracy: 0.9678
Epoch 6/10

















































































































1353/1353 [==============================] - ETA: 0s - loss: 1.2909 - output_steps_loss: 1.2354 - output_success_loss: 0.1110 - output_success_accuracy: 0.9677Restoring model weights from the end of the best epoch: 2.
1353/1353 [==============================] - 241s 178ms/step - loss: 1.2909 - output_steps_loss: 1.2354 - output_success_loss: 0.1110 - output_success_accuracy: 0.9677 - val_loss: 1.3715 - val_output_steps_loss: 1.3161 - val_output_success_loss: 0.1107 - val_output_success_accuracy: 0.9678
Epoch 6: early stopping
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
âœ… Lossæ›²çº¿å·²ä¿å­˜è‡³: visualization\LSTM_loss_curve.png
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...





194/194 [==============================] - 12s 60ms/step
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...











387/387 [==============================] - 25s 63ms/step
========================================
  LSTMæ¨¡å‹éªŒè¯å’Œæµ‹è¯•æŠ¥å‘Š
========================================
---- éªŒè¯é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9178
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1249
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.709%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8643
5. å¤§å‹è¯¯å·®ç‡ (>2.0æ­¥)  : 6.945%
6. ç²¾ç¡®ç‡ (Precision)    : 0.3871
7. å¬å›ç‡ (Recall)       : 0.1812
8. F1å€¼ (F1-Score)       : 0.1581
---- æµ‹è¯•é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9181
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1245
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.713%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8664
5. å¤§å‹è¯¯å·®ç‡ (>2.0æ­¥)  : 6.918%
6. ç²¾ç¡®ç‡ (Precision)    : 0.3860
7. å¬å›ç‡ (Recall)       : 0.1805
8. F1å€¼ (F1-Score)       : 0.1568
========================================
ğŸ” å¼€å§‹æ‰§è¡Œperform_validationå‡½æ•°...
ğŸ” ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·æ•°é‡: 138387, æŠ½æ ·æ•°é‡: 10000
ğŸ” å·²æŠ½å– 10 ä¸ªç”¨æˆ·è¿›è¡Œå±•ç¤º
Step 5: å¯åŠ¨å›æµ‹éªŒè¯æŠ½æ ·æŠ¥å‘Š (æ ·æœ¬æ•°=10000, è¾“å‡ºè‡³ outputs/lstm_output.txt)...
----------------------------------------------------------------------
User ID    | Bias  | Diff  | Real  | Pred  | Disc  | Err   | Status
----------------------------------------------------------------------
25062      | 5.41  | 3.90  | 5    | 4.90  | 5      | 0.10  | âœ…
600451     | 5.10  | 4.14  | 3    | 4.55  | 5      | 1.55  | âš ï¸
291041     | 4.17  | 4.53  | 4    | 4.24  | 4      | 0.24  | âœ…
725542     | 4.57  | 4.72  | 3    | 4.82  | 5      | 1.82  | âš ï¸
336398     | 3.98  | 4.64  | 6    | 4.15  | 4      | 1.85  | âš ï¸
340391     | 4.06  | 4.51  | 4    | 4.13  | 4      | 0.13  | âœ…
255287     | 4.69  | 4.46  | 4    | 4.66  | 5      | 0.66  | âœ…
807835     | 6.18  | 4.04  | 6    | 5.65  | 6      | 0.35  | âœ…
577718     | 3.51  | 4.13  | 3    | 3.34  | 3      | 0.34  | âœ…
105508     | 4.20  | 3.76  | 2    | 3.41  | 3      | 1.41  | âš ï¸
... (å…¶ä½™ 9990 æ¡çœç•¥)
âœ… æŠ½æ ·æŠ¥å‘Šå·²æˆåŠŸå¯¼å‡ºè‡³ outputs/lstm_output.txt æ–‡ä»¶ã€‚
âœ… é¢„æµ‹è¶‹åŠ¿å›¾å·²ä¿å­˜è‡³: visualization\LSTM_prediction_trends.png
âœ… æ··æ·†çŸ©é˜µå·²ä¿å­˜è‡³: visualization\LSTM_confusion_matrix.png