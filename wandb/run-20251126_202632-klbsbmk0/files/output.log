
Step 1: è¯»å–æ•°æ®å¹¶æ„å»ºå››ç‰¹å¾...
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
f:\Codes\Wd-Pred\LSTM_prediction.py:79: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›† 2770743, éªŒè¯é›† 395820, æµ‹è¯•é›† 791642
Step 3: æ£€æµ‹åˆ°å·²ä¿å­˜æ¨¡å‹ LSTM_Modelï¼Œå°è¯•åŠ è½½...
âŒ æ¨¡å‹åŠ è½½å¤±è´¥: SavedModel file does not exist at: LSTM_Model\{saved_model.pbtxt|saved_model.pb}. å°†é‡æ–°æ„å»ºå¹¶è®­ç»ƒæ¨¡å‹ã€‚
Step 3: æ„å»ºå››è¾“å…¥ç¥ç»ç½‘ç»œ (Vocab=321)...
Step 4: å¼€å§‹è®­ç»ƒ (Epochs=15, Batch=2048)...
Epoch 1/15































































1353/1353 [==============================] - 136s 99ms/step - loss: 1.5690 - output_steps_loss: 1.4896 - output_success_loss: 0.1589 - output_success_accuracy: 0.9544 - val_loss: 1.5722 - val_output_steps_loss: 1.5139 - val_output_success_loss: 0.1166 - val_output_success_accuracy: 0.9664
Epoch 2/15

































































1353/1353 [==============================] - 137s 101ms/step - loss: 1.3088 - output_steps_loss: 1.2510 - output_success_loss: 0.1156 - output_success_accuracy: 0.9669 - val_loss: 1.7400 - val_output_steps_loss: 1.6847 - val_output_success_loss: 0.1106 - val_output_success_accuracy: 0.9673
Epoch 3/15




































































1353/1353 [==============================] - 143s 106ms/step - loss: 1.2965 - output_steps_loss: 1.2404 - output_success_loss: 0.1122 - output_success_accuracy: 0.9673 - val_loss: 1.7432 - val_output_steps_loss: 1.6874 - val_output_success_loss: 0.1115 - val_output_success_accuracy: 0.9676
Epoch 4/15



































































1353/1353 [==============================] - 142s 105ms/step - loss: 1.2931 - output_steps_loss: 1.2375 - output_success_loss: 0.1112 - output_success_accuracy: 0.9675 - val_loss: 1.7452 - val_output_steps_loss: 1.6904 - val_output_success_loss: 0.1095 - val_output_success_accuracy: 0.9678
Epoch 5/15








































































1353/1353 [==============================] - 152s 113ms/step - loss: 1.2906 - output_steps_loss: 1.2352 - output_success_loss: 0.1107 - output_success_accuracy: 0.9676 - val_loss: 1.7335 - val_output_steps_loss: 1.6788 - val_output_success_loss: 0.1094 - val_output_success_accuracy: 0.9678
Epoch 6/15









































































1353/1353 [==============================] - 156s 115ms/step - loss: 1.2892 - output_steps_loss: 1.2341 - output_success_loss: 0.1103 - output_success_accuracy: 0.9676 - val_loss: 1.6899 - val_output_steps_loss: 1.6353 - val_output_success_loss: 0.1091 - val_output_success_accuracy: 0.9679
Epoch 7/15









































































1353/1353 [==============================] - 155s 114ms/step - loss: 1.2879 - output_steps_loss: 1.2329 - output_success_loss: 0.1100 - output_success_accuracy: 0.9677 - val_loss: 1.6637 - val_output_steps_loss: 1.6092 - val_output_success_loss: 0.1091 - val_output_success_accuracy: 0.9679
Epoch 8/15











































































1353/1353 [==============================] - 160s 118ms/step - loss: 1.2869 - output_steps_loss: 1.2321 - output_success_loss: 0.1097 - output_success_accuracy: 0.9677 - val_loss: 1.6904 - val_output_steps_loss: 1.6355 - val_output_success_loss: 0.1099 - val_output_success_accuracy: 0.9677
Epoch 9/15











































































1353/1353 [==============================] - 160s 118ms/step - loss: 1.2860 - output_steps_loss: 1.2313 - output_success_loss: 0.1094 - output_success_accuracy: 0.9679 - val_loss: 1.7064 - val_output_steps_loss: 1.6515 - val_output_success_loss: 0.1097 - val_output_success_accuracy: 0.9674
Epoch 10/15











































































1353/1353 [==============================] - 159s 117ms/step - loss: 1.2854 - output_steps_loss: 1.2307 - output_success_loss: 0.1092 - output_success_accuracy: 0.9678 - val_loss: 1.6659 - val_output_steps_loss: 1.6112 - val_output_success_loss: 0.1095 - val_output_success_accuracy: 0.9678
Epoch 11/15











































































1353/1353 [==============================] - 158s 117ms/step - loss: 1.2850 - output_steps_loss: 1.2304 - output_success_loss: 0.1091 - output_success_accuracy: 0.9678 - val_loss: 1.6291 - val_output_steps_loss: 1.5743 - val_output_success_loss: 0.1097 - val_output_success_accuracy: 0.9678
Epoch 12/15











































































1353/1353 [==============================] - 159s 117ms/step - loss: 1.2846 - output_steps_loss: 1.2301 - output_success_loss: 0.1091 - output_success_accuracy: 0.9678 - val_loss: 1.6311 - val_output_steps_loss: 1.5765 - val_output_success_loss: 0.1092 - val_output_success_accuracy: 0.9678
Epoch 13/15











































































1353/1353 [==============================] - 160s 118ms/step - loss: 1.2842 - output_steps_loss: 1.2297 - output_success_loss: 0.1090 - output_success_accuracy: 0.9679 - val_loss: 1.6303 - val_output_steps_loss: 1.5747 - val_output_success_loss: 0.1111 - val_output_success_accuracy: 0.9677
Epoch 14/15










































































1353/1353 [==============================] - 158s 117ms/step - loss: 1.2840 - output_steps_loss: 1.2295 - output_success_loss: 0.1089 - output_success_accuracy: 0.9679 - val_loss: 1.6224 - val_output_steps_loss: 1.5672 - val_output_success_loss: 0.1104 - val_output_success_accuracy: 0.9677
Epoch 15/15










































































1353/1353 [==============================] - 158s 117ms/step - loss: 1.2837 - output_steps_loss: 1.2293 - output_success_loss: 0.1089 - output_success_accuracy: 0.9679 - val_loss: 1.6723 - val_output_steps_loss: 1.6173 - val_output_success_loss: 0.1102 - val_output_success_accuracy: 0.9678
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
âœ… Lossæ›²çº¿å·²ä¿å­˜è‡³: visualization\LSTM_loss_curve.png
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...




194/194 [==============================] - 9s 46ms/step
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...







387/387 [==============================] - 17s 45ms/step
========================================
  LSTMæ¨¡å‹éªŒè¯å’Œæµ‹è¯•æŠ¥å‘Š
========================================
---- éªŒè¯é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 1.0361
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.2717
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.782%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8744
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 25.751%
---- æµ‹è¯•é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 1.0365
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.2716
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.783%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8759
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 25.881%
========================================
ğŸ” å¼€å§‹æ‰§è¡Œperform_validationå‡½æ•°...
ğŸ” ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·æ•°é‡: 138387, æŠ½æ ·æ•°é‡: 10000
ğŸ” å·²æŠ½å– 10 ä¸ªç”¨æˆ·è¿›è¡Œå±•ç¤º
Step 5: å¯åŠ¨å›æµ‹éªŒè¯æŠ½æ ·æŠ¥å‘Š (æ ·æœ¬æ•°=10000, è¾“å‡ºè‡³ outputs/lstm_output.txt)...
------------------------------------------------------------
User ID    | Bias  | Diff  | Real  | Pred  | Err   | Status
------------------------------------------------------------
842158     | 3.66  | 4.46  | 3    | 3.41  | 0.41  | âœ…
729286     | 5.11  | 4.26  | 5    | 4.41  | 0.59  | âœ…
767637     | 4.13  | 4.35  | 3    | 3.70  | 0.70  | âœ…
384793     | 4.61  | 4.26  | 5    | 3.86  | 1.14  | âš ï¸
380502     | 3.80  | 3.96  | 6    | 3.06  | 2.94  | âŒ
560725     | 4.93  | 5.46  | 3    | 4.81  | 1.81  | âŒ
503067     | 5.25  | 4.20  | 5    | 4.36  | 0.64  | âœ…
332335     | 3.40  | 4.29  | 2    | 2.82  | 0.82  | âœ…
1706       | 3.96  | 3.52  | 2    | 2.79  | 0.79  | âœ…
907460     | 3.92  | 4.20  | 4    | 3.35  | 0.65  | âœ…
... (å…¶ä½™ 9990 æ¡çœç•¥)
âœ… æŠ½æ ·æŠ¥å‘Šå·²æˆåŠŸå¯¼å‡ºè‡³ outputs/lstm_output.txt æ–‡ä»¶ã€‚
âœ… é¢„æµ‹è¶‹åŠ¿å›¾å·²ä¿å­˜è‡³: visualization\LSTM_prediction_trends.png