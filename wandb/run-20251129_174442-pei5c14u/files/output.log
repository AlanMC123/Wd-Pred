
Step 1: 读取数据并构建四特征...
Step 2: 构建四输入样本...
F:\Codes\Wd-Pred\transformer_prediction.py:86: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
数据集划分：训练集 2770743, 验证集 395820, 测试集 791642
Step 3: 构建Transformer神经网络 (Vocab=321, Layers=2)...
Step 4: 开始训练 (Epochs=10, Batch=2048, Patience=4)...
Epoch 1/10























1353/1353 [==============================] - 52s 37ms/step - loss: 1.7682 - output_steps_loss: 1.6848 - output_success_loss: 0.1668 - output_success_accuracy: 0.9604 - val_loss: 1.3367 - val_output_steps_loss: 1.2743 - val_output_success_loss: 0.1248 - val_output_success_accuracy: 0.9664
Epoch 2/10
























1353/1353 [==============================] - 52s 38ms/step - loss: 1.3299 - output_steps_loss: 1.2694 - output_success_loss: 0.1211 - output_success_accuracy: 0.9667 - val_loss: 1.2995 - val_output_steps_loss: 1.2435 - val_output_success_loss: 0.1120 - val_output_success_accuracy: 0.9664
Epoch 3/10


























1353/1353 [==============================] - 56s 42ms/step - loss: 1.3089 - output_steps_loss: 1.2513 - output_success_loss: 0.1152 - output_success_accuracy: 0.9667 - val_loss: 1.2902 - val_output_steps_loss: 1.2341 - val_output_success_loss: 0.1120 - val_output_success_accuracy: 0.9664
Epoch 4/10




























1353/1353 [==============================] - 61s 45ms/step - loss: 1.3022 - output_steps_loss: 1.2455 - output_success_loss: 0.1135 - output_success_accuracy: 0.9667 - val_loss: 1.2905 - val_output_steps_loss: 1.2347 - val_output_success_loss: 0.1117 - val_output_success_accuracy: 0.9664
Epoch 5/10



























1353/1353 [==============================] - 61s 45ms/step - loss: 1.2965 - output_steps_loss: 1.2404 - output_success_loss: 0.1122 - output_success_accuracy: 0.9674 - val_loss: 1.3004 - val_output_steps_loss: 1.2449 - val_output_success_loss: 0.1111 - val_output_success_accuracy: 0.9677
Epoch 6/10






