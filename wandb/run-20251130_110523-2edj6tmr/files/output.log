
Step 1: 读取数据并构建四特征...
Step 2: 构建四输入样本...
f:\Codes\Wd-Pred\transformer_prediction.py:89: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
数据集划分：训练集 2770743, 验证集 395820, 测试集 791642
Step 3: 构建Transformer神经网络 (Vocab=321, Layers=4)...
✅ 模型编译完成，使用Focal Loss (gamma=2.0, alpha=0.25)
Step 4: 开始训练 (Epochs=15, Batch=4096, Patience=4)...
Epoch 1/15
































































677/677 [==============================] - 142s 203ms/step - loss: 2.4279 - output_steps_loss: 2.4156 - output_success_loss: 0.0245 - output_success_accuracy: 0.9659 - val_loss: 1.2924 - val_output_steps_loss: 1.2809 - val_output_success_loss: 0.0230 - val_output_success_accuracy: 0.9664
Epoch 2/15





































































677/677 [==============================] - 149s 220ms/step - loss: 1.4142 - output_steps_loss: 1.4038 - output_success_loss: 0.0207 - output_success_accuracy: 0.9667 - val_loss: 1.2751 - val_output_steps_loss: 1.2659 - val_output_success_loss: 0.0184 - val_output_success_accuracy: 0.9669
Epoch 3/15



































































677/677 [==============================] - 143s 210ms/step - loss: 1.3444 - output_steps_loss: 1.3352 - output_success_loss: 0.0183 - output_success_accuracy: 0.9645 - val_loss: 1.3253 - val_output_steps_loss: 1.3167 - val_output_success_loss: 0.0171 - val_output_success_accuracy: 0.9667
Epoch 4/15




































































677/677 [==============================] - 147s 218ms/step - loss: 1.2932 - output_steps_loss: 1.2844 - output_success_loss: 0.0177 - output_success_accuracy: 0.9623 - val_loss: 1.2868 - val_output_steps_loss: 1.2784 - val_output_success_loss: 0.0169 - val_output_success_accuracy: 0.9664
Epoch 5/15













































































677/677 [==============================] - 163s 241ms/step - loss: 1.2719 - output_steps_loss: 1.2633 - output_success_loss: 0.0173 - output_success_accuracy: 0.9617 - val_loss: 1.2703 - val_output_steps_loss: 1.2618 - val_output_success_loss: 0.0168 - val_output_success_accuracy: 0.9661
Epoch 6/15




































