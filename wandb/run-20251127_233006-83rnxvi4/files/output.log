
Step 1: è¯»å–æ•°æ®å¹¶æ„å»ºå››ç‰¹å¾...
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
f:\Codes\Wd-Pred\LSTM_prediction.py:80: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›† 2770743, éªŒè¯é›† 395820, æµ‹è¯•é›† 791642
Step 3: æ„å»ºå››è¾“å…¥ç¥ç»ç½‘ç»œ (Vocab=321)...
Step 4: å¼€å§‹è®­ç»ƒ (Epochs=10, Batch=2048)...
Epoch 1/10
























































































































1353/1353 [==============================] - 260s 191ms/step - loss: 1.5955 - output_steps_loss: 1.5162 - output_success_loss: 0.1586 - output_success_accuracy: 0.9550 - val_loss: 1.4574 - val_output_steps_loss: 1.3997 - val_output_success_loss: 0.1155 - val_output_success_accuracy: 0.9664
Epoch 2/10


















































































































1353/1353 [==============================] - 240s 177ms/step - loss: 1.3163 - output_steps_loss: 1.2577 - output_success_loss: 0.1172 - output_success_accuracy: 0.9670 - val_loss: 1.5397 - val_output_steps_loss: 1.4844 - val_output_success_loss: 0.1105 - val_output_success_accuracy: 0.9675
Epoch 3/10





















































































































1353/1353 [==============================] - 248s 183ms/step - loss: 1.2999 - output_steps_loss: 1.2438 - output_success_loss: 0.1123 - output_success_accuracy: 0.9673 - val_loss: 1.5679 - val_output_steps_loss: 1.5130 - val_output_success_loss: 0.1098 - val_output_success_accuracy: 0.9676
Epoch 4/10



















































































































1353/1353 [==============================] - 244s 180ms/step - loss: 1.2940 - output_steps_loss: 1.2385 - output_success_loss: 0.1110 - output_success_accuracy: 0.9675 - val_loss: 1.5640 - val_output_steps_loss: 1.5091 - val_output_success_loss: 0.1097 - val_output_success_accuracy: 0.9678
Epoch 5/10





















































































































1353/1353 [==============================] - ETA: 0s - loss: 1.2911 - output_steps_loss: 1.2359 - output_success_loss: 0.1104 - output_success_accuracy: 0.9676Restoring model weights from the end of the best epoch: 1.
1353/1353 [==============================] - 248s 183ms/step - loss: 1.2911 - output_steps_loss: 1.2359 - output_success_loss: 0.1104 - output_success_accuracy: 0.9676 - val_loss: 1.5447 - val_output_steps_loss: 1.4901 - val_output_success_loss: 0.1091 - val_output_success_accuracy: 0.9679
Epoch 5: early stopping
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
âœ… Lossæ›²çº¿å·²ä¿å­˜è‡³: visualization\LSTM_loss_curve.png
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...






194/194 [==============================] - 13s 67ms/step
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...












387/387 [==============================] - 26s 66ms/step
========================================
  LSTMæ¨¡å‹éªŒè¯å’Œæµ‹è¯•æŠ¥å‘Š
========================================
---- éªŒè¯é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9648
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1831
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.639%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8538
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 21.312%
---- æµ‹è¯•é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9651
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1827
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.653%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8553
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 21.340%
========================================
ğŸ” å¼€å§‹æ‰§è¡Œperform_validationå‡½æ•°...
ğŸ” ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·æ•°é‡: 138387, æŠ½æ ·æ•°é‡: 10000
ğŸ” å·²æŠ½å– 10 ä¸ªç”¨æˆ·è¿›è¡Œå±•ç¤º
Step 5: å¯åŠ¨å›æµ‹éªŒè¯æŠ½æ ·æŠ¥å‘Š (æ ·æœ¬æ•°=10000, è¾“å‡ºè‡³ outputs/lstm_output.txt)...
------------------------------------------------------------
User ID    | Bias  | Diff  | Real  | Pred  | Err   | Status
------------------------------------------------------------
545167     | 3.73  | 4.65  | 6    | 3.77  | 2.23  | âŒ
868841     | 4.53  | 4.72  | 5    | 4.54  | 0.46  | âœ…
429072     | 2.93  | 4.43  | 2    | 2.56  | 0.56  | âœ…
541817     | 3.98  | 4.14  | 5    | 3.48  | 1.52  | âŒ
883888     | 4.05  | 4.51  | 3    | 3.86  | 0.86  | âœ…
142157     | 5.18  | 4.57  | 6    | 4.95  | 1.05  | âš ï¸
473434     | 4.83  | 4.23  | 6    | 4.32  | 1.68  | âŒ
706951     | 4.33  | 4.19  | 5    | 3.89  | 1.11  | âš ï¸
880009     | 3.99  | 4.18  | 2    | 3.53  | 1.53  | âŒ
746888     | 3.64  | 4.53  | 4    | 3.60  | 0.40  | âœ…
... (å…¶ä½™ 9990 æ¡çœç•¥)
âœ… æŠ½æ ·æŠ¥å‘Šå·²æˆåŠŸå¯¼å‡ºè‡³ outputs/lstm_output.txt æ–‡ä»¶ã€‚
âœ… é¢„æµ‹è¶‹åŠ¿å›¾å·²ä¿å­˜è‡³: visualization\LSTM_prediction_trends.png