
Step 1: è¯»å–æ•°æ®å¹¶æ„å»ºå››ç‰¹å¾...
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
f:\Codes\Wd-Pred\LSTM_prediction.py:79: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›† 2770743, éªŒè¯é›† 395820, æµ‹è¯•é›† 791642
Step 3: æ„å»ºå››è¾“å…¥ç¥ç»ç½‘ç»œ (Vocab=321)...
Step 4: å¼€å§‹è®­ç»ƒ (Epochs=10, Batch=2048)...
Epoch 1/10































































1353/1353 [==============================] - 136s 99ms/step - loss: 1.6137 - output_steps_loss: 1.5308 - output_success_loss: 0.1658 - output_success_accuracy: 0.9549 - val_loss: 1.4929 - val_output_steps_loss: 1.4343 - val_output_success_loss: 0.1171 - val_output_success_accuracy: 0.9664
Epoch 2/10



































































1353/1353 [==============================] - 142s 105ms/step - loss: 1.3110 - output_steps_loss: 1.2530 - output_success_loss: 0.1159 - output_success_accuracy: 0.9670 - val_loss: 1.6740 - val_output_steps_loss: 1.6186 - val_output_success_loss: 0.1108 - val_output_success_accuracy: 0.9673
Epoch 3/10



































































1353/1353 [==============================] - 142s 105ms/step - loss: 1.2972 - output_steps_loss: 1.2411 - output_success_loss: 0.1122 - output_success_accuracy: 0.9674 - val_loss: 1.6643 - val_output_steps_loss: 1.6095 - val_output_success_loss: 0.1097 - val_output_success_accuracy: 0.9677
Epoch 4/10





































































1353/1353 [==============================] - 145s 107ms/step - loss: 1.2930 - output_steps_loss: 1.2374 - output_success_loss: 0.1113 - output_success_accuracy: 0.9675 - val_loss: 1.6376 - val_output_steps_loss: 1.5823 - val_output_success_loss: 0.1107 - val_output_success_accuracy: 0.9675
Epoch 5/10




































































1353/1353 [==============================] - 144s 106ms/step - loss: 1.2905 - output_steps_loss: 1.2351 - output_success_loss: 0.1108 - output_success_accuracy: 0.9676 - val_loss: 1.6123 - val_output_steps_loss: 1.5574 - val_output_success_loss: 0.1097 - val_output_success_accuracy: 0.9678
Epoch 6/10




































































1353/1353 [==============================] - 145s 107ms/step - loss: 1.2888 - output_steps_loss: 1.2336 - output_success_loss: 0.1103 - output_success_accuracy: 0.9677 - val_loss: 1.5743 - val_output_steps_loss: 1.5191 - val_output_success_loss: 0.1103 - val_output_success_accuracy: 0.9675
Epoch 7/10






































































1353/1353 [==============================] - 148s 110ms/step - loss: 1.2879 - output_steps_loss: 1.2329 - output_success_loss: 0.1100 - output_success_accuracy: 0.9677 - val_loss: 1.6225 - val_output_steps_loss: 1.5678 - val_output_success_loss: 0.1094 - val_output_success_accuracy: 0.9678
Epoch 8/10








































































1353/1353 [==============================] - 153s 113ms/step - loss: 1.2871 - output_steps_loss: 1.2322 - output_success_loss: 0.1098 - output_success_accuracy: 0.9677 - val_loss: 1.5713 - val_output_steps_loss: 1.5162 - val_output_success_loss: 0.1102 - val_output_success_accuracy: 0.9675
Epoch 9/10







































































1353/1353 [==============================] - 150s 111ms/step - loss: 1.2864 - output_steps_loss: 1.2317 - output_success_loss: 0.1096 - output_success_accuracy: 0.9677 - val_loss: 1.5701 - val_output_steps_loss: 1.5150 - val_output_success_loss: 0.1100 - val_output_success_accuracy: 0.9677
Epoch 10/10










































































1353/1353 [==============================] - 153s 113ms/step - loss: 1.2859 - output_steps_loss: 1.2312 - output_success_loss: 0.1094 - output_success_accuracy: 0.9678 - val_loss: 1.5919 - val_output_steps_loss: 1.5366 - val_output_success_loss: 0.1105 - val_output_success_accuracy: 0.9677
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
âœ… Lossæ›²çº¿å·²ä¿å­˜è‡³: visualization\LSTM_loss_curve.png
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...


194/194 [==============================] - 8s 38ms/step
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...






387/387 [==============================] - 14s 37ms/step
========================================
  LSTMæ¨¡å‹éªŒè¯å’Œæµ‹è¯•æŠ¥å‘Š
========================================
---- éªŒè¯é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 1.0096
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.2396
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.773%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8732
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 23.732%
---- æµ‹è¯•é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 1.0100
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.2394
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.772%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8753
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 23.831%
========================================
ğŸ” å¼€å§‹æ‰§è¡Œperform_validationå‡½æ•°...
ğŸ” ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·æ•°é‡: 138387, æŠ½æ ·æ•°é‡: 10000
ğŸ” å·²æŠ½å– 10 ä¸ªç”¨æˆ·è¿›è¡Œå±•ç¤º
Step 5: å¯åŠ¨å›æµ‹éªŒè¯æŠ½æ ·æŠ¥å‘Š (æ ·æœ¬æ•°=10000, è¾“å‡ºè‡³ outputs/lstm_output.txt)...
------------------------------------------------------------
User ID    | Bias  | Diff  | Real  | Pred  | Err   | Status
------------------------------------------------------------
851427     | 4.90  | 4.65  | 5    | 4.55  | 0.45  | âœ…
368472     | 5.07  | 4.72  | 6    | 4.73  | 1.27  | âš ï¸
425482     | 3.48  | 3.95  | 2    | 2.93  | 0.93  | âœ…
356071     | 4.37  | 4.45  | 5    | 3.96  | 1.04  | âš ï¸
673496     | 4.76  | 4.52  | 7    | 4.37  | 2.63  | âŒ
789638     | 5.14  | 4.57  | 4    | 4.43  | 0.43  | âœ…
92310      | 2.95  | 4.89  | 2    | 3.14  | 1.14  | âš ï¸
116948     | 4.00  | 3.66  | 2    | 2.89  | 0.89  | âœ…
163685     | 4.57  | 4.49  | 5    | 4.25  | 0.75  | âœ…
670314     | 4.16  | 4.46  | 6    | 3.87  | 2.13  | âŒ
... (å…¶ä½™ 9990 æ¡çœç•¥)
âœ… æŠ½æ ·æŠ¥å‘Šå·²æˆåŠŸå¯¼å‡ºè‡³ outputs/lstm_output.txt æ–‡ä»¶ã€‚
âœ… é¢„æµ‹è¶‹åŠ¿å›¾å·²ä¿å­˜è‡³: visualization\LSTM_prediction_trends.png