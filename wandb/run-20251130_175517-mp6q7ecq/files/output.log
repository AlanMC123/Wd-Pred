===== åŠ è½½æ‰€æœ‰é¢„å¤„ç†æ•°æ®é›† =====
Step 1: åŠ è½½é¢„å¤„ç†åçš„æ•°æ® - train_data.csv
  è¯»å–æ•°æ®é›†å®Œæˆï¼Œå…±3632544æ¡è®°å½•ï¼Œè€—æ—¶: 2.50ç§’
  åˆ›å»ºå•è¯IDå®Œæˆï¼Œè¯æ±‡è¡¨å¤§å°: 321ï¼Œè€—æ—¶: 17.98ç§’
  è¯»å–å•è¯éš¾åº¦æ•°æ®...
  è¯»å–ç”¨æˆ·æ°´å¹³æ•°æ®...
  æ„å»ºå†å²æ•°æ®æ˜ å°„...
  æ•°æ®åŠ è½½å’Œé¢„å¤„ç†å®Œæˆï¼Œæ€»è€—æ—¶: 28.37ç§’
  æ€§èƒ½ç»Ÿè®¡:
    - æ•°æ®è¯»å–: 2.50ç§’
    - å•è¯IDåˆ›å»º: 17.98ç§’
    - å•è¯éš¾åº¦åŠ è½½: 0.13ç§’
    - ç”¨æˆ·æ°´å¹³åŠ è½½: 0.15ç§’
    - å†å²æ˜ å°„æ„å»º: 6.39ç§’
Step 1: åŠ è½½é¢„å¤„ç†åçš„æ•°æ® - val_data.csv
  è¯»å–æ•°æ®é›†å®Œæˆï¼Œå…±518935æ¡è®°å½•ï¼Œè€—æ—¶: 0.37ç§’
  åˆ›å»ºå•è¯IDå®Œæˆï¼Œè¯æ±‡è¡¨å¤§å°: 321ï¼Œè€—æ—¶: 2.73ç§’
  è¯»å–å•è¯éš¾åº¦æ•°æ®...
  è¯»å–ç”¨æˆ·æ°´å¹³æ•°æ®...
  æ„å»ºå†å²æ•°æ®æ˜ å°„...
  æ•°æ®åŠ è½½å’Œé¢„å¤„ç†å®Œæˆï¼Œæ€»è€—æ—¶: 8.92ç§’
  æ€§èƒ½ç»Ÿè®¡:
    - æ•°æ®è¯»å–: 0.37ç§’
    - å•è¯IDåˆ›å»º: 2.73ç§’
    - å•è¯éš¾åº¦åŠ è½½: 0.02ç§’
    - ç”¨æˆ·æ°´å¹³åŠ è½½: 0.12ç§’
    - å†å²æ˜ å°„æ„å»º: 5.58ç§’
Step 1: åŠ è½½é¢„å¤„ç†åçš„æ•°æ® - test_data.csv
  è¯»å–æ•°æ®é›†å®Œæˆï¼Œå…±1037870æ¡è®°å½•ï¼Œè€—æ—¶: 0.73ç§’
  åˆ›å»ºå•è¯IDå®Œæˆï¼Œè¯æ±‡è¡¨å¤§å°: 321ï¼Œè€—æ—¶: 5.39ç§’
  è¯»å–å•è¯éš¾åº¦æ•°æ®...
  è¯»å–ç”¨æˆ·æ°´å¹³æ•°æ®...
  æ„å»ºå†å²æ•°æ®æ˜ å°„...
  æ•°æ®åŠ è½½å’Œé¢„å¤„ç†å®Œæˆï¼Œæ€»è€—æ—¶: 12.06ç§’
  æ€§èƒ½ç»Ÿè®¡:
    - æ•°æ®è¯»å–: 0.73ç§’
    - å•è¯IDåˆ›å»º: 5.39ç§’
    - å•è¯éš¾åº¦åŠ è½½: 0.03ç§’
    - ç”¨æˆ·æ°´å¹³åŠ è½½: 0.12ç§’
    - å†å²æ˜ å°„æ„å»º: 5.55ç§’
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
æ•°æ®é›†æ„å»ºå®Œæˆ: å…±2468390ä¸ªæ ·æœ¬
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
æ•°æ®é›†æ„å»ºå®Œæˆ: å…±83482ä¸ªæ ·æœ¬
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
æ•°æ®é›†æ„å»ºå®Œæˆ: å…±374266ä¸ªæ ·æœ¬
===== æ‰€æœ‰æ•°æ®é›†å‡†å¤‡å®Œæˆ =====
æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›† 2468390, éªŒè¯é›† 83482, æµ‹è¯•é›† 374266
âœ… æ•°æ®åŠ è½½ä¼˜åŒ–å·²åº”ç”¨ (cache + prefetch)
Step 3: æ„å»ºTransformerç¥ç»ç½‘ç»œ (Vocab=321, Layers=3)...
WARNING:tensorflow:From D:\Python\Python312\Lib\site-packages\keras\src\backend\tensorflow\core.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

D:\Python\Python312\Lib\site-packages\keras\src\layers\core\embedding.py:97: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
âœ… æ¨¡å‹ç¼–è¯‘å®Œæˆï¼Œä½¿ç”¨Focal Loss (gamma=2.0, alpha=0.25)
Step 4: å¼€å§‹è®­ç»ƒ (Epochs=10, Batch=4096, Patience=5)...
æç¤º: å½“å‰ä½¿ç”¨CPUè®­ç»ƒï¼Œé€Ÿåº¦å¯èƒ½è¾ƒæ…¢ã€‚å»ºè®®ä½¿ç”¨æ”¯æŒCUDAçš„GPUä»¥è·å¾—æ˜¾è‘—åŠ é€Ÿã€‚
Epoch 1/10
[1m603/603[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m91s[0m 144ms/step - loss: 1.9872 - output_steps_loss: 1.9763 - output_success_accuracy: 0.9673 - output_success_loss: 0.0209 - val_loss: 1.2008 - val_output_steps_loss: 1.1918 - val_output_success_accuracy: 0.9701 - val_output_success_loss: 0.0166
Epoch 2/10
[1m603/603[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m97s[0m 161ms/step - loss: 1.2762 - output_steps_loss: 1.2676 - output_success_accuracy: 0.9677 - output_success_loss: 0.0172 - val_loss: 1.2078 - val_output_steps_loss: 1.1990 - val_output_success_accuracy: 0.9688 - val_output_success_loss: 0.0158
Epoch 3/10
[1m603/603[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m92s[0m 153ms/step - loss: 1.2413 - output_steps_loss: 1.2330 - output_success_accuracy: 0.9657 - output_success_loss: 0.0166 - val_loss: 1.2129 - val_output_steps_loss: 1.2040 - val_output_success_accuracy: 0.9688 - val_output_success_loss: 0.0158
Epoch 4/10
[1m603/603[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m87s[0m 145ms/step - loss: 1.2169 - output_steps_loss: 1.2088 - output_success_accuracy: 0.9650 - output_success_loss: 0.0163 - val_loss: 1.2281 - val_output_steps_loss: 1.2189 - val_output_success_accuracy: 0.9700 - val_output_success_loss: 0.0162
Epoch 5/10
[1m603/603[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m87s[0m 145ms/step - loss: 1.2064 - output_steps_loss: 1.1984 - output_success_accuracy: 0.9647 - output_success_loss: 0.0160 - val_loss: 1.2402 - val_output_steps_loss: 1.2308 - val_output_success_accuracy: 0.9702 - val_output_success_loss: 0.0163
Epoch 6/10
[1m603/603[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m88s[0m 145ms/step - loss: 1.2018 - output_steps_loss: 1.1939 - output_success_accuracy: 0.9646 - output_success_loss: 0.0158 - val_loss: 1.2373 - val_output_steps_loss: 1.2280 - val_output_success_accuracy: 0.9702 - val_output_success_loss: 0.0161
âœ… Lossæ›²çº¿å·²ä¿å­˜è‡³: visualization\Transformer_loss_curve.png

âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°: models/Transformer_Model.keras

Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...
[1m21/21[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m2s[0m 71ms/step
Traceback (most recent call last):
  File "f:\Codes\Wd-Pred\transformer_prediction.py", line 937, in <module>
    main()
  File "f:\Codes\Wd-Pred\transformer_prediction.py", line 803, in main
    'input_history': X_s[test_idx],
                         ^^^^^^^^
NameError: name 'test_idx' is not defined
