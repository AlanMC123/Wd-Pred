
Step 1: è¯»å–æ•°æ®å¹¶æ„å»ºå››ç‰¹å¾...
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
f:\Codes\Wd-Pred\LSTM_prediction.py:84: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›† 2770743, éªŒè¯é›† 395820, æµ‹è¯•é›† 791642
Step 3: æ„å»ºå››è¾“å…¥ç¥ç»ç½‘ç»œ (Vocab=321)...
âœ… æ¨¡å‹ç¼–è¯‘å®Œæˆï¼Œä½¿ç”¨Focal Loss (gamma=2.0, alpha=0.25)
Step 4: å¼€å§‹è®­ç»ƒ (Epochs=10, Batch=2048)...
Epoch 1/10



































































































1353/1353 [==============================] - 211s 154ms/step - loss: 1.6066 - output_steps_loss: 1.5960 - output_success_loss: 0.0214 - output_success_accuracy: 0.9580 - val_loss: 1.2469 - val_output_steps_loss: 1.2384 - val_output_success_loss: 0.0171 - val_output_success_accuracy: 0.9653
Epoch 2/10

































































































1353/1353 [==============================] - 206s 152ms/step - loss: 1.2858 - output_steps_loss: 1.2772 - output_success_loss: 0.0173 - output_success_accuracy: 0.9621 - val_loss: 1.2454 - val_output_steps_loss: 1.2371 - val_output_success_loss: 0.0166 - val_output_success_accuracy: 0.9651
Epoch 3/10





































































































1353/1353 [==============================] - 213s 157ms/step - loss: 1.2584 - output_steps_loss: 1.2500 - output_success_loss: 0.0167 - output_success_accuracy: 0.9612 - val_loss: 1.2515 - val_output_steps_loss: 1.2431 - val_output_success_loss: 0.0168 - val_output_success_accuracy: 0.9671
Epoch 4/10














































































































1353/1353 [==============================] - 232s 172ms/step - loss: 1.2491 - output_steps_loss: 1.2409 - output_success_loss: 0.0163 - output_success_accuracy: 0.9615 - val_loss: 1.2747 - val_output_steps_loss: 1.2663 - val_output_success_loss: 0.0168 - val_output_success_accuracy: 0.9670
Epoch 5/10

















































































































1353/1353 [==============================] - 239s 177ms/step - loss: 1.2458 - output_steps_loss: 1.2377 - output_success_loss: 0.0162 - output_success_accuracy: 0.9620 - val_loss: 1.2431 - val_output_steps_loss: 1.2350 - val_output_success_loss: 0.0161 - val_output_success_accuracy: 0.9650
Epoch 6/10












































































































1353/1353 [==============================] - 230s 170ms/step - loss: 1.2437 - output_steps_loss: 1.2357 - output_success_loss: 0.0161 - output_success_accuracy: 0.9620 - val_loss: 1.2597 - val_output_steps_loss: 1.2515 - val_output_success_loss: 0.0165 - val_output_success_accuracy: 0.9668
Epoch 7/10













































































































1353/1353 [==============================] - 230s 170ms/step - loss: 1.2422 - output_steps_loss: 1.2342 - output_success_loss: 0.0160 - output_success_accuracy: 0.9621 - val_loss: 1.2585 - val_output_steps_loss: 1.2504 - val_output_success_loss: 0.0161 - val_output_success_accuracy: 0.9666
Epoch 8/10







































































































1353/1353 [==============================] - 218s 161ms/step - loss: 1.2415 - output_steps_loss: 1.2335 - output_success_loss: 0.0160 - output_success_accuracy: 0.9622 - val_loss: 1.2611 - val_output_steps_loss: 1.2530 - val_output_success_loss: 0.0163 - val_output_success_accuracy: 0.9670
Epoch 9/10










































































































1353/1353 [==============================] - ETA: 0s - loss: 1.2405 - output_steps_loss: 1.2326 - output_success_loss: 0.0159 - output_success_accuracy: 0.9624Restoring model weights from the end of the best epoch: 5.
1353/1353 [==============================] - 226s 167ms/step - loss: 1.2405 - output_steps_loss: 1.2326 - output_success_loss: 0.0159 - output_success_accuracy: 0.9624 - val_loss: 1.2735 - val_output_steps_loss: 1.2653 - val_output_success_loss: 0.0164 - val_output_success_accuracy: 0.9675
Epoch 9: early stopping
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
âœ… Lossæ›²çº¿å·²ä¿å­˜è‡³: visualization\LSTM_loss_curve.png
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...




194/194 [==============================] - 12s 61ms/step
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...














387/387 [==============================] - 31s 81ms/step
========================================
  LSTMæ¨¡å‹éªŒè¯å’Œæµ‹è¯•æŠ¥å‘Š
========================================
---- éªŒè¯é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9053
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1113
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.502%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8664
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 18.107%
---- æµ‹è¯•é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9056
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1110
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.512%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8687
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 18.040%
========================================
ğŸ” å¼€å§‹æ‰§è¡Œperform_validationå‡½æ•°...
ğŸ” ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·æ•°é‡: 138387, æŠ½æ ·æ•°é‡: 10000
ğŸ” å·²æŠ½å– 10 ä¸ªç”¨æˆ·è¿›è¡Œå±•ç¤º
Step 5: å¯åŠ¨å›æµ‹éªŒè¯æŠ½æ ·æŠ¥å‘Š (æ ·æœ¬æ•°=10000, è¾“å‡ºè‡³ outputs/lstm_output.txt)...
------------------------------------------------------------
User ID    | Bias  | Diff  | Real  | Pred  | Err   | Status
------------------------------------------------------------
274748     | 4.69  | 3.66  | 5    | 3.98  | 1.02  | âš ï¸
928094     | 6.44  | 4.66  | 7    | 6.71  | 0.29  | âœ…
950636     | 3.72  | 4.16  | 5    | 3.55  | 1.45  | âš ï¸
503110     | 4.50  | 3.96  | 5    | 4.16  | 0.84  | âœ…
237457     | 3.73  | 4.37  | 4    | 3.67  | 0.33  | âœ…
54373      | 5.30  | 4.35  | 6    | 5.09  | 0.91  | âœ…
975200     | 4.00  | 4.10  | 4    | 3.81  | 0.19  | âœ…
360234     | 4.29  | 3.52  | 5    | 3.48  | 1.52  | âŒ
51269      | 4.30  | 4.72  | 5    | 4.75  | 0.25  | âœ…
517494     | 4.33  | 3.91  | 3    | 3.71  | 0.71  | âœ…
... (å…¶ä½™ 9990 æ¡çœç•¥)
âœ… æŠ½æ ·æŠ¥å‘Šå·²æˆåŠŸå¯¼å‡ºè‡³ outputs/lstm_output.txt æ–‡ä»¶ã€‚
âœ… é¢„æµ‹è¶‹åŠ¿å›¾å·²ä¿å­˜è‡³: visualization\LSTM_prediction_trends.png