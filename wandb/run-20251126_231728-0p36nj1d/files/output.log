
Step 1: è¯»å–æ•°æ®å¹¶æ„å»ºå››ç‰¹å¾...
Step 2: æ„å»ºå››è¾“å…¥æ ·æœ¬...
f:\Codes\Wd-Pred\LSTM_prediction.py:79: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  history_map = df.groupby('Username').apply(
æ•°æ®é›†åˆ’åˆ†ï¼šè®­ç»ƒé›† 2770743, éªŒè¯é›† 395820, æµ‹è¯•é›† 791642
Step 3: æ„å»ºå››è¾“å…¥ç¥ç»ç½‘ç»œ (Vocab=321)...
Step 4: å¼€å§‹è®­ç»ƒ (Epochs=10, Batch=2048)...
Epoch 1/10







































































1353/1353 [==============================] - 153s 112ms/step - loss: 1.6225 - output_steps_loss: 1.5463 - output_success_loss: 0.1524 - output_success_accuracy: 0.9639 - val_loss: 1.5699 - val_output_steps_loss: 1.5116 - val_output_success_loss: 0.1166 - val_output_success_accuracy: 0.9664
Epoch 2/10







































































1353/1353 [==============================] - 154s 114ms/step - loss: 1.3180 - output_steps_loss: 1.2600 - output_success_loss: 0.1160 - output_success_accuracy: 0.9667 - val_loss: 1.5399 - val_output_steps_loss: 1.4844 - val_output_success_loss: 0.1110 - val_output_success_accuracy: 0.9664
Epoch 3/10








































































1353/1353 [==============================] - 155s 115ms/step - loss: 1.3009 - output_steps_loss: 1.2448 - output_success_loss: 0.1123 - output_success_accuracy: 0.9671 - val_loss: 1.5324 - val_output_steps_loss: 1.4775 - val_output_success_loss: 0.1099 - val_output_success_accuracy: 0.9677
Epoch 4/10










































































1353/1353 [==============================] - 158s 116ms/step - loss: 1.2939 - output_steps_loss: 1.2383 - output_success_loss: 0.1110 - output_success_accuracy: 0.9676 - val_loss: 1.4754 - val_output_steps_loss: 1.4207 - val_output_success_loss: 0.1095 - val_output_success_accuracy: 0.9678
Epoch 5/10










































































1353/1353 [==============================] - 158s 117ms/step - loss: 1.2909 - output_steps_loss: 1.2356 - output_success_loss: 0.1104 - output_success_accuracy: 0.9677 - val_loss: 1.4730 - val_output_steps_loss: 1.4184 - val_output_success_loss: 0.1092 - val_output_success_accuracy: 0.9679
Epoch 6/10









































































1353/1353 [==============================] - 156s 115ms/step - loss: 1.2885 - output_steps_loss: 1.2335 - output_success_loss: 0.1100 - output_success_accuracy: 0.9677 - val_loss: 1.4898 - val_output_steps_loss: 1.4343 - val_output_success_loss: 0.1111 - val_output_success_accuracy: 0.9675
Epoch 7/10










































































1353/1353 [==============================] - 158s 117ms/step - loss: 1.2874 - output_steps_loss: 1.2326 - output_success_loss: 0.1097 - output_success_accuracy: 0.9678 - val_loss: 1.4670 - val_output_steps_loss: 1.4124 - val_output_success_loss: 0.1092 - val_output_success_accuracy: 0.9678
Epoch 8/10









































































1353/1353 [==============================] - 153s 113ms/step - loss: 1.2863 - output_steps_loss: 1.2316 - output_success_loss: 0.1094 - output_success_accuracy: 0.9678 - val_loss: 1.4876 - val_output_steps_loss: 1.4320 - val_output_success_loss: 0.1111 - val_output_success_accuracy: 0.9674
Epoch 9/10




































































1353/1353 [==============================] - 145s 107ms/step - loss: 1.2856 - output_steps_loss: 1.2310 - output_success_loss: 0.1093 - output_success_accuracy: 0.9678 - val_loss: 1.5018 - val_output_steps_loss: 1.4460 - val_output_success_loss: 0.1116 - val_output_success_accuracy: 0.9671
Epoch 10/10









































































1353/1353 [==============================] - 153s 113ms/step - loss: 1.2850 - output_steps_loss: 1.2304 - output_success_loss: 0.1091 - output_success_accuracy: 0.9678 - val_loss: 1.4870 - val_output_steps_loss: 1.4322 - val_output_success_loss: 0.1097 - val_output_success_accuracy: 0.9677
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
âœ… Lossæ›²çº¿å·²ä¿å­˜è‡³: visualization\LSTM_loss_curve.png
âœ… æ¨¡å‹å·²æˆåŠŸä¿å­˜åˆ°æ–‡ä»¶å¤¹: LSTM_Model
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...



194/194 [==============================] - 7s 35ms/step
Step 4: å¼€å§‹æ‰¹é‡é¢„æµ‹ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡...






387/387 [==============================] - 15s 38ms/step
========================================
  LSTMæ¨¡å‹éªŒè¯å’Œæµ‹è¯•æŠ¥å‘Š
========================================
---- éªŒè¯é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9758
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1967
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.774%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8745
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 22.069%
---- æµ‹è¯•é›†æŒ‡æ ‡ ----
1. å¹³å‡æ­¥æ•°è¯¯å·® (MAE)    : 0.9762
2. å‡æ–¹æ ¹è¯¯å·® (RMSE)     : 1.1965
3. èƒœè´Ÿé¢„æµ‹å‡†ç¡®ç‡        : 96.771%
4. ROCæ›²çº¿ä¸‹é¢ç§¯ (AUC)   : 0.8762
5. å¤§å‹è¯¯å·®ç‡ (>1.5æ­¥)  : 22.129%
========================================
ğŸ” å¼€å§‹æ‰§è¡Œperform_validationå‡½æ•°...
ğŸ” ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·æ•°é‡: 138387, æŠ½æ ·æ•°é‡: 10000
ğŸ” å·²æŠ½å– 10 ä¸ªç”¨æˆ·è¿›è¡Œå±•ç¤º
Step 5: å¯åŠ¨å›æµ‹éªŒè¯æŠ½æ ·æŠ¥å‘Š (æ ·æœ¬æ•°=10000, è¾“å‡ºè‡³ outputs/lstm_output.txt)...
------------------------------------------------------------
User ID    | Bias  | Diff  | Real  | Pred  | Err   | Status
------------------------------------------------------------
856269     | 5.91  | 4.59  | 3    | 5.43  | 2.43  | âŒ
670204     | 4.15  | 3.82  | 3    | 3.26  | 0.26  | âœ…
272853     | 4.79  | 4.24  | 6    | 4.25  | 1.75  | âŒ
495956     | 3.45  | 4.19  | 2    | 3.08  | 1.08  | âš ï¸
670292     | 5.54  | 4.35  | 6    | 4.90  | 1.10  | âš ï¸
513586     | 4.48  | 4.19  | 4    | 3.95  | 0.05  | âœ…
789210     | 3.81  | 4.14  | 3    | 3.33  | 0.33  | âœ…
149328     | 4.00  | 3.82  | 2    | 3.01  | 1.01  | âš ï¸
852458     | 5.45  | 4.59  | 6    | 5.09  | 0.91  | âœ…
472809     | 4.81  | 4.44  | 6    | 4.29  | 1.71  | âŒ
... (å…¶ä½™ 9990 æ¡çœç•¥)
âœ… æŠ½æ ·æŠ¥å‘Šå·²æˆåŠŸå¯¼å‡ºè‡³ outputs/lstm_output.txt æ–‡ä»¶ã€‚
âœ… é¢„æµ‹è¶‹åŠ¿å›¾å·²ä¿å­˜è‡³: visualization\LSTM_prediction_trends.png